<mxfile host="65bd71144e">
    <diagram id="9jb1CFWFvMTh5ldz3Q-j" name="Page-1">
        <mxGraphModel dx="2284" dy="795" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0" adaptiveColors="auto">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="4" value="Story Prompt" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fa6800;fontColor=#000000;strokeColor=#C73500;" parent="1" vertex="1">
                    <mxGeometry x="40" y="80" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="5" value="&lt;font style=&quot;font-size: 21px;&quot;&gt;Chat View&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="35" y="20" width="130" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="6" value="Chapter&lt;br&gt;- Description" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0a30a;fontColor=#000000;strokeColor=#BD7000;" parent="1" vertex="1">
                    <mxGeometry x="40" y="150" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="7" value="Chapter 2&lt;br&gt;- Description" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0a30a;fontColor=#000000;strokeColor=#BD7000;" parent="1" vertex="1">
                    <mxGeometry x="40" y="380" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="8" value="Message 10" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e;" parent="1" vertex="1">
                    <mxGeometry x="40" y="260" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="9" value="Message 11" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#76608a;fontColor=#ffffff;strokeColor=#432D57;" parent="1" vertex="1">
                    <mxGeometry x="50" y="300" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="10" value="Message 12" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e;" parent="1" vertex="1">
                    <mxGeometry x="40" y="340" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="11" value="Message 13" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e;" parent="1" vertex="1">
                    <mxGeometry x="40" y="450" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="12" value="Message 14" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#76608a;fontColor=#ffffff;strokeColor=#432D57;" parent="1" vertex="1">
                    <mxGeometry x="50" y="600" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="13" value="Message 15" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e;" parent="1" vertex="1">
                    <mxGeometry x="40" y="640" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="14" value="&lt;font style=&quot;font-size: 9px;&quot;&gt;[... Collapsed Messages]&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=default;fontColor=#ffffff;strokeColor=#432D57;" parent="1" vertex="1">
                    <mxGeometry x="40" y="220" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="15" value="Image" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#647687;fontColor=#ffffff;strokeColor=#314354;" parent="1" vertex="1">
                    <mxGeometry x="40" y="490" width="120" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="16" value="&lt;div&gt;Role: System&lt;/div&gt;[Story Prompt]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fa6800;fontColor=#000000;strokeColor=#C73500;" parent="1" vertex="1">
                    <mxGeometry x="280" y="80" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="17" value="Role: System&lt;br&gt;[End of Chapter] [Previous Description]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0a30a;fontColor=#000000;strokeColor=#BD7000;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="280" y="120" width="120" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="18" value="&lt;font style=&quot;color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;span&gt;Role: System&lt;/span&gt;&lt;br style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;&lt;span&gt;[End of Chapter] [Previous Description]&lt;/span&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0a30a;fontColor=light-dark(default, #ffffff);strokeColor=#BD7000;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="280" y="290" width="120" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="19" value="Role: Assistant&lt;br&gt;[Message 10]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e;" parent="1" vertex="1">
                    <mxGeometry x="280" y="170" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="20" value="&lt;div&gt;&lt;font style=&quot;&quot;&gt;Role: User&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;&quot;&gt;[Message 11]&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#76608a;fontColor=light-dark(#FFFFFF,#FFFFFF);strokeColor=#432D57;" parent="1" vertex="1">
                    <mxGeometry x="290" y="210" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="21" value="Role: Assistant&lt;div&gt;[Message 12]&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e;" parent="1" vertex="1">
                    <mxGeometry x="280" y="250" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="22" value="Role: User&lt;br&gt;[Message 13]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e;" parent="1" vertex="1">
                    <mxGeometry x="290" y="340" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="23" value="Role: Assistant&lt;div&gt;[Message 14]&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#76608a;fontColor=#ffffff;strokeColor=#432D57;" parent="1" vertex="1">
                    <mxGeometry x="280" y="380" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="24" value="Role: User&lt;div&gt;[Message 15]&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e;" parent="1" vertex="1">
                    <mxGeometry x="290" y="420" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="27" value="&lt;font style=&quot;font-size: 21px;&quot;&gt;LLM View&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="275" y="20" width="130" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="28" value="&lt;font style=&quot;font-size: 21px;&quot;&gt;Event Log&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="515" y="20" width="130" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="41" value="role: chapter&lt;div&gt;title: Chapter 1&lt;/div&gt;&lt;div&gt;summary:&amp;nbsp;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0a30a;fontColor=#000000;strokeColor=#BD7000;" parent="1" vertex="1">
                    <mxGeometry x="520" y="240" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="42" value="Chapter 2&lt;br&gt;- Description" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0a30a;fontColor=#000000;strokeColor=#BD7000;" parent="1" vertex="1">
                    <mxGeometry x="520" y="470" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="43" value="Message 10" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e;" parent="1" vertex="1">
                    <mxGeometry x="520" y="350" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="44" value="Message 11" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#76608a;fontColor=#ffffff;strokeColor=#432D57;" parent="1" vertex="1">
                    <mxGeometry x="530" y="390" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="45" value="Message 12" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e;" parent="1" vertex="1">
                    <mxGeometry x="520" y="430" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="46" value="Message 13" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e;" parent="1" vertex="1">
                    <mxGeometry x="520" y="540" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="47" value="Message 14" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#76608a;fontColor=#ffffff;strokeColor=#432D57;" parent="1" vertex="1">
                    <mxGeometry x="530" y="690" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="48" value="Message 15" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e;" parent="1" vertex="1">
                    <mxGeometry x="520" y="730" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="49" value="&lt;font style=&quot;font-size: 9px;&quot;&gt;[... Collapsed Messages]&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=default;fontColor=#ffffff;strokeColor=#432D57;" parent="1" vertex="1">
                    <mxGeometry x="520" y="310" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="50" value="Image" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#647687;fontColor=#ffffff;strokeColor=#314354;" parent="1" vertex="1">
                    <mxGeometry x="520" y="580" width="120" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="51" value="&lt;div&gt;role: system&lt;/div&gt;Message 1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d0cee2;strokeColor=#56517e;" parent="1" vertex="1">
                    <mxGeometry x="520" y="80" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="53" value="&lt;div&gt;role: user&lt;/div&gt;Message 2" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#76608a;fontColor=#ffffff;strokeColor=#432D57;" parent="1" vertex="1">
                    <mxGeometry x="530" y="120" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="54" value="&lt;div&gt;role: edit&lt;/div&gt;&lt;div&gt;messageId: 2&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" parent="1" vertex="1">
                    <mxGeometry x="520" y="160" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="55" value="&lt;div&gt;role: delete&lt;/div&gt;&lt;div&gt;messageId: 2&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
                    <mxGeometry x="520" y="200" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="64" value="" style="edgeStyle=none;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="57" target="77" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="240" y="935" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="57" value="User" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="140" y="920" width="40" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="67" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="63" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="550" y="935" as="targetPoint"/>
                        <mxPoint x="470" y="965" as="sourcePoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="71" style="edgeStyle=none;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="470" y="975" as="sourcePoint"/>
                        <mxPoint x="550" y="975" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="74" style="edgeStyle=none;html=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;" parent="1" source="63" target="65" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="63" value="Chat Event Service" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="360" y="920" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="75" style="edgeStyle=none;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" parent="1" source="65" target="63" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="65" value="Chat History API" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="360" y="870" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="68" value="User Chat Projection" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="550" y="920" width="122.5" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="79" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="77" target="63" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="77" value="Chat Service" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="230" y="920" width="90" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="83" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;&lt;font&gt;Chat Event Service&lt;/font&gt;&lt;/h1&gt;&lt;p&gt;&lt;font&gt;&lt;font&gt;UserChatConsumer: ChatViewService;&lt;br&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;LLMChatConsumer: LLMChatConsumer;&lt;br&gt;&lt;br&gt;Messages: Message[] | undefined = undefined;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;&lt;font&gt;- Initialize()&lt;br&gt;&amp;nbsp; - UserChatConsumer = new UserChatConsumer()&lt;br&gt;&amp;nbsp; - LLMChatConsumer = new LLMChatConsumer();&lt;br&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - Messages = ChatHistoryApi.GetChatHistory(chatId)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - initializeChatConsumers()&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;&lt;font&gt;- initializeChatConsumers()&lt;/font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; - for (message in Messages)&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font&gt;&lt;font&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; - UserChatConsumer.Process(message)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; - LLMChatConsumer.Process(message)&lt;br&gt;&lt;br&gt;- AddMessage(message: Message)&lt;br&gt;&amp;nbsp; - await ChatHistoryAPI.addChatMessage(message)&lt;br&gt;&lt;/font&gt;&amp;nbsp; - UserChatConsumer.Process(message)&lt;br&gt;&amp;nbsp; - LLMChatConsumer.Process(message)&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="390" y="1040" width="400" height="380" as="geometry"/>
                </mxCell>
                <mxCell id="84" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;&lt;font&gt;Chat Service&lt;/font&gt;&lt;/h1&gt;&lt;p&gt;&lt;font style=&quot;&quot;&gt;- Initialize()&lt;br&gt;&amp;nbsp; - ChatEventService = new()&lt;br&gt;&amp;nbsp; - ChatEventService.Initialize()&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font style=&quot;&quot;&gt;- AddUserMessage(string message)&lt;br&gt;&amp;nbsp; - userMessage = UserMessageUtil.Create(message)&lt;br&gt;&lt;font style=&quot;&quot;&gt;&amp;nbsp; - await ChatEventService.AddMessage(userMessage)&lt;br&gt;&amp;nbsp; - notifySubscribers()&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font style=&quot;&quot;&gt;- AddSystemMessage(string message)&lt;br&gt;&amp;nbsp; - systemMessage = SystemMessageUtil.Create(message)&lt;br&gt;&amp;nbsp; - await ChatEventService.AddMessage(message)&lt;br&gt;&amp;nbsp; - notifySubscribers()&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font style=&quot;&quot;&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;-&lt;/span&gt;&lt;font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt; AddAssistantMessage(string message)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - systemMessage = AssistantMessageUtil.Create(message)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - await ChatEventService.AddMessage(message)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - notifySubscribers()&lt;/span&gt;&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font style=&quot;&quot;&gt;- AddCivitJobMessage(string jobId, string prompt)&lt;br&gt;&amp;nbsp; - civitJobMessage = CivitJobMessageUtil.Create(jobId, prompt)&lt;br&gt;&amp;nbsp; - await ChatEventService.AddMessage(civitJobMessage)&lt;br&gt;&amp;nbsp; - notifySubscribers()&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font style=&quot;&quot;&gt;&lt;span style=&quot;&quot;&gt;- EditMessage(messageId: string, newContent: string)&lt;br&gt;&amp;nbsp; - editMessage =&amp;nbsp; EditMessageUtil.Create(messageId, newContent);Message&lt;/span&gt;&lt;span style=&quot;&quot;&gt;&lt;br&gt;&amp;nbsp; - await ChatEventService.AddMessage(editMessage)&lt;/span&gt;&lt;span style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;&lt;br style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;&lt;/span&gt;&lt;font&gt;&lt;span style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;&amp;nbsp; - notifySubscribers();&lt;/span&gt;&lt;span style=&quot;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;br&gt;- AddChapter(title: string, description: string)&lt;br&gt;&amp;nbsp; - addChapterMessage = AddChapterMessageUtil.Create(title, description)&lt;br&gt;&amp;nbsp; - await ChatEventService.AddMessage(addChapterMessage);&lt;br&gt;&amp;nbsp; - notifySubscribers();&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font style=&quot;&quot;&gt;&lt;font style=&quot;&quot;&gt;&lt;br&gt;&lt;font&gt;- EditChapter(title: string, prompt: string)&lt;/font&gt;&lt;font&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - editChapterMessage = EditChapterMessageUtil.Create(title, description)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - await ChatEventService.AddMessage(addChapterMessage);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - notifySubscribers();&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font style=&quot;&quot;&gt;- DeleteChapter(chapterId: string)&lt;br&gt;&amp;nbsp; - deleteChapterMessage = DeleteChapterMessageUtil.Create(chapterId)&lt;br&gt;&amp;nbsp; - await ChatEventService.AddMessage(deleteChapterMessage)&lt;br&gt;&amp;nbsp; - notifySubscribers()&lt;br&gt;&lt;br&gt;- GetLLMChatMessages()&lt;br&gt;&amp;nbsp; - LLMChatConsumer.GetMessages()&lt;br&gt;&lt;br&gt;- GetUserChatMessages()&lt;br&gt;&amp;nbsp; - UserChatConsumer.GetMessages()&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font&gt;&lt;br&gt;// Sub / Notify Pattern&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;fontColor=light-dark(#000000,#FFFFFF);" parent="1" vertex="1">
                    <mxGeometry y="1040" width="400" height="870" as="geometry"/>
                </mxCell>
                <mxCell id="85" value="LLM Chat Projection" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="550" y="960" width="125" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="87" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Limitations and Consequences&amp;nbsp;&lt;/h1&gt;&lt;p&gt;- This approach will require duplicate code in both consumers, particularly around the chapter logic. That&#39;s a lot of complexity to manage in two places.&lt;br&gt;&lt;br&gt;- After a chapter is created, to be edited we would need to manipulate the messages hidden in the chapter messages. To minimize complexity, we should lock the chapter&#39;s messages after it has been &#39;created&#39;&lt;br&gt;&lt;br&gt;- Creating a chapter is easiest if we just assume all standard messages are at the end of the list. There isn&#39;t a possibility of Chapter -&amp;gt; Message -&amp;gt; Chapter, so all StandardMessages in the Messages[] are part of the current Chapter. This has the implication that chapters are finalized once they&#39;re created. I.E you can&#39;t really delete but keep all of the messages of the second chapter if the third has already been created.&amp;nbsp;&lt;br&gt;&lt;br&gt;-&amp;nbsp;&lt;/p&gt;" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="760" y="560" width="385" height="410" as="geometry"/>
                </mxCell>
                <mxCell id="88" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;&lt;font&gt;User Chat Consumer&lt;/font&gt;&lt;/h1&gt;&lt;p&gt;&lt;font&gt;Messages: Message[]&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;ChapterMessageLists: ChapterMessageList []&lt;br&gt;&lt;br&gt;- constructor()&lt;br&gt;&amp;nbsp; - Messages: Message[] = []&lt;br&gt;&lt;br&gt;- Process(message: Message)&lt;br&gt;&amp;nbsp; - if(IsStandardMessage(message))&lt;br&gt;&amp;nbsp; &amp;nbsp; - ProcessStandardMessage(message)&lt;br&gt;&amp;nbsp; - if(message.role == &quot;edit&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp; - ProcessEditMessage(message)&lt;br&gt;&amp;nbsp; - if...&lt;br&gt;&lt;br&gt;&lt;span&gt;- GetMessages()&lt;/span&gt;&lt;br style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;&lt;span&gt;&amp;nbsp; - return Messages&lt;br&gt;&lt;br&gt;- GetChapterMessages(chapterId: string)&lt;br&gt;&amp;nbsp; - ChapterMessageLists.first(x=&amp;gt;x.chapterId == chapterId).Messages&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;&lt;font&gt;&lt;font&gt;- isStandardMessage(message: Message)&lt;br&gt;&lt;font style=&quot;&quot;&gt;&amp;nbsp; -&amp;nbsp;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font style=&quot;&quot;&gt;message.role == &quot;assistant&quot; | &quot;system&quot; | &quot;user&quot; | &quot;civit-job&quot;&lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;&lt;font&gt;- p&lt;span&gt;rocessStandard&lt;/span&gt;(standardMessage: Message)&lt;br&gt;&amp;nbsp; - Messages.Add(assistantMessage: Message)&lt;br&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font&gt;&lt;br&gt;- processEdit(editMessage: EditMessage)&lt;br&gt;&amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;- editMessageContent = JSON.parse(editMessage.content)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - message = GetMessage(editMessageContent.id)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - message.content = editMessageContent.newContent&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - UpdateMessage(message)&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font&gt;&lt;br&gt;- processDelete(deleteMessage: DeleteMessage)&lt;br&gt;&amp;nbsp; - deleteMessageContent = JSON.parse(deleteMessage.content)&lt;br&gt;&amp;nbsp; - DeleteMessage(deleteMessageContent.id)&lt;br&gt;&amp;nbsp;&lt;br&gt;&lt;/font&gt;- processChapter(chapterMessage: ChapterMessage)&lt;br&gt;&amp;nbsp; - chapterMessageContent = JSON.parse(chapterMessage.content)&amp;nbsp;&lt;br&gt;&amp;nbsp; - chapterMessages = GetAllStandardMessages()&lt;br&gt;&amp;nbsp; - chapterMessageList = new ChatperMessageList(chapterMessage.id, chapterMessages)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - ChapterMessageLists.Add(chapterContent)&amp;nbsp;&amp;nbsp;&lt;br&gt;&amp;nbsp; - DeleteMessages(chapterContents)&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp;&lt;br&gt;&amp;nbsp; - Messages.Add(chapterMessage)&lt;br&gt;&lt;br&gt;- processChapterEdit(chapterEditMessage : ChapterEditMessage)&lt;br&gt;&amp;nbsp; - message = GetMessage(id)&lt;br&gt;&amp;nbsp; - message.content = chapterEditMessage.content&lt;br&gt;&amp;nbsp; - UpdateMessage(message)&lt;br&gt;&lt;br&gt;- processChapterDelete(chapterDeleteMessage: ChapterDeleteMessage)&lt;br&gt;&amp;nbsp; - chapterDeleteContent = JSON.parser(chapterDeleteMessage.content)&lt;br&gt;&amp;nbsp; - DeleteMessage(chapterDeleteContent.messageId)&lt;br&gt;&amp;nbsp; - chapterMessageList = ChapterMessageList.where(x=&amp;gt;x.chapterMessageId == chapterDeleteContent.messageId)&lt;br&gt;&amp;nbsp; - if(chapterDeleteContent.DeleteAllMessages)&lt;br&gt;&amp;nbsp; &amp;nbsp; - ChapterMessageLists.remove(chapterDeleteMessage)&lt;br&gt;&amp;nbsp; - else&lt;br&gt;&amp;nbsp; &amp;nbsp;- foreach(message in chapterMessageList) Process(message)&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font&gt;- getAllStandardMessages()&lt;br&gt;&amp;nbsp; - standardMessages = Messages.filter(m =&amp;gt; IsStandardMessage(m))&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="850" y="1040" width="760" height="920" as="geometry"/>
                </mxCell>
                <mxCell id="89" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;&lt;font&gt;To Add Messages:&lt;/font&gt;&lt;/h1&gt;&lt;p&gt;- chatService = d.ChatService(chatId) // Gets the cached singleton instance of the chat service&lt;br&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;fontColor=light-dark(#000000,#FFFFFF);" parent="1" vertex="1">
                    <mxGeometry x="-560" y="1040" width="520" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="90" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;&lt;font&gt;UseUserChatMessages&lt;/font&gt;&lt;/h1&gt;&lt;p&gt;&lt;font&gt;&lt;font&gt;- private chatService = d.ChatService(chatId) // Gets the cached singleton instance of the chat service&lt;br&gt;&amp;nbsp;&lt;br&gt;- userChatMessages : Message[]&lt;br&gt;&lt;br&gt;- GetUserChapterMessages(chapterId:&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font&gt;&amp;nbsp; - chatService.UserChatConsumer.ChapterMessageLists.first(x=&amp;gt;x.chapterId == chapterId)&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font&gt;// Subscribe to chatService notifications&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;- OnNotify()&lt;br&gt;&amp;nbsp; - userChatMessages = chatService.UserChatConsumer.GetAllMessages()&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;fontColor=light-dark(#000000,#FFFFFF);" parent="1" vertex="1">
                    <mxGeometry x="-560" y="1160" width="560" height="220" as="geometry"/>
                </mxCell>
                <mxCell id="91" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;&lt;font&gt;UseLLMChatMessages&lt;/font&gt;&lt;/h1&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font&gt;- private chatService = d.ChatService(chatId) // Gets the cached singleton instance of the chat service&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;&lt;font style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;&lt;font style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;- llmChatMessages : Message[]&lt;br style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;&lt;br style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;- GetLLMChapterMessages(chapterId:&amp;nbsp;&lt;span style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30); background-color: transparent;&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30); background-color: transparent;&quot;&gt;)&lt;br style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;&lt;/span&gt;&lt;/font&gt;&lt;span style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30); background-color: transparent;&quot;&gt;&lt;font style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;&amp;nbsp; - chatService.GetLLMChapterMessages()&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;&lt;font style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;// Subscribe to chatService notifications&lt;br style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;&lt;br style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;- OnNotify()&lt;br style=&quot;scrollbar-color: rgb(75, 75, 75) rgb(27, 29, 30);&quot;&gt;&amp;nbsp; - llmChatMessages = chatService.GetLLMChatMessages()&lt;/font&gt;&lt;/p&gt;" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;fontColor=light-dark(#000000,#FFFFFF);" parent="1" vertex="1">
                    <mxGeometry x="-560" y="1380" width="560" height="220" as="geometry"/>
                </mxCell>
                <mxCell id="92" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;&lt;font&gt;LLM Chat Consumer&lt;/font&gt;&lt;/h1&gt;&lt;p&gt;&lt;font&gt;Messages: Message[]&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;&lt;span style=&quot;color: rgb(192, 192, 192); background-color: transparent;&quot;&gt;NumberOfPreviousChapterMessages&lt;/span&gt;&amp;nbsp;= 6; // Number of previous chapter messages to include when a chapter is &#39;created&#39;. Since chapters are minted after a length of content, we want to include a few messages from the previous chapter like this:&lt;br&gt;// Chapter 1&lt;br&gt;// Chapter 2&lt;br&gt;// [Messages from Chapter 3]&lt;br&gt;// Chapter 3&lt;br&gt;// Ongoing Messages for the next chapter&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;ChapterMessageLists: ChapterMessageList []&lt;br&gt;&lt;br&gt;- constructor()&lt;br&gt;&amp;nbsp; - Messages: Message[] = []&lt;br&gt;&lt;br&gt;- Process(message: Message)&lt;br&gt;&amp;nbsp; - if (message.role == &quot;civit-job&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp; - return; // Civit Job messages can be ignored for LLM purposes.&lt;br&gt;&amp;nbsp; - if(IsStandardMessage(message))&lt;br&gt;&amp;nbsp; &amp;nbsp; - ProcessStandardMessage(message)&lt;br&gt;&amp;nbsp; - if(message.role == &quot;edit&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp; - ProcessEditMessage(message)&lt;br&gt;&amp;nbsp; - if...&lt;br&gt;&lt;br&gt;&lt;span&gt;- GetMessages()&lt;br&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp; - if(HasOutgrownPreviousChapterBuffer())&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- return Messages&lt;br&gt;&amp;nbsp; - previousChapter = GetPreviousChapter&lt;br&gt;&amp;nbsp; - bufferOfPreviousChapterMessages = GetLastMessages(previousChapter.id, NumberOfPreviousChapterMessagesToInclude)&lt;br&gt;&amp;nbsp; - previousChapterIndex = GetPreviousChapterIndex(previousChapter.Id)&amp;nbsp;&lt;br&gt;&amp;nbsp; - splicedMessages = AddMessagesBeforeIndex(previousChapterIndex)&lt;br&gt;&amp;nbsp; - return splicedMessages&lt;br&gt;&lt;br&gt;- hasOutgrownPreviousChapterBuffer()&lt;br&gt;&amp;nbsp; - // if the user has more than &#39;NumberOfPreviousChapterMessages&#39; StandardMessages after the most recent previous chapter&#39;s index, we have outgrown the chapter buffer. No need to include previous messages, we likely have enough examples of the conversation&#39;s flow.&lt;br&gt;&lt;br&gt;- GetChapterMessages(chapterId: string)&lt;br&gt;&amp;nbsp; - ChapterMessageLists.first(x=&amp;gt;x.chapterId == chapterId).Messages&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;&lt;font&gt;&lt;font&gt;- isStandardMessage(message: Message)&lt;br&gt;&lt;font style=&quot;&quot;&gt;&amp;nbsp; -&amp;nbsp;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font style=&quot;&quot;&gt;message.role == &quot;assistant&quot; | &quot;system&quot; | &quot;user&quot;; // Civit Job messages aren&#39;t considered standard for the LLM Consumer&lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;&lt;font&gt;- p&lt;span&gt;rocessStandard&lt;/span&gt;(standardMessage: Message)&lt;br&gt;&amp;nbsp; - Messages.Add(assistantMessage: Message)&lt;br&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font&gt;User&lt;br&gt;&lt;br&gt;- processEdit(editMessage: EditMessage)&lt;br&gt;&amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;- editMessageContent = JSON.parse(editMessage.content)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - message = GetMessage(editMessageContent.id)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - message.content = editMessageContent.newContent&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - UpdateMessage(message)&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font&gt;&lt;br&gt;- processDelete(deleteMessage: DeleteMessage)&lt;br&gt;&amp;nbsp; - deleteMessageContent = JSON.parse(deleteMessage.content)&lt;br&gt;&amp;nbsp; - DeleteMessage(deleteMessageContent.id)&lt;br&gt;&amp;nbsp;&lt;br&gt;&lt;/font&gt;- processChapter(chapterMessage: ChapterMessage)&lt;br&gt;&amp;nbsp; - chapterMessageContent = JSON.parse(chapterMessage.content)&amp;nbsp;&lt;br&gt;&amp;nbsp; - chapterMessages = GetAllStandardMessages()&lt;br&gt;&amp;nbsp; - chapterMessageList = new ChapterMessageList(chapterMessage.id, chapterMessages)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - ChapterMessageLists.Add(chapterContent)&amp;nbsp;&amp;nbsp;&lt;br&gt;&amp;nbsp; - DeleteMessages(chapterContents)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp; - formattedChapterMessage = FormatChapterMessageForLLM(chapterMessage)&amp;nbsp;&lt;br&gt;&amp;nbsp; - Messages.Add(formattedChapterMessage)&lt;br&gt;&lt;br&gt;- formatChapterMessageForLLM(ti: ChapterMessage)&lt;br&gt;&amp;nbsp; - message = new Message()&lt;br&gt;&amp;nbsp;{&lt;br&gt;&amp;nbsp;role = &quot;system&quot;,&lt;br&gt;&amp;nbsp; id = chapterMessage.id,&lt;br&gt;&amp;nbsp; content = &quot;[Previous Chapter Summary:&quot; + chapterMessage.title + &quot;]\r\n&quot; + chapterMessage.description + &quot;\r\n [End of Chapter Summary]&quot;&lt;br&gt;}&lt;br&gt;&amp;nbsp; - return message;&lt;br&gt;&lt;br&gt;- processChapterEdit(chapterEditMessage : ChapterEditMessage)&lt;br&gt;&amp;nbsp; - chapterEditMessageContent = JSON.parse(chapterEditMessage)&lt;br&gt;&amp;nbsp; - existingMesage = GetMessage(id)&lt;br&gt;&amp;nbsp; -&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: rgb(192, 192, 192);&quot;&gt;existingMesage&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;.content = formatChapterMessageForLLM(chapterEditMessage.content)&lt;br&gt;&amp;nbsp; - UpdateMessage(message)&lt;br&gt;&lt;br&gt;- processChapterDelete(chapterDeleteMessage: ChapterDeleteMessage)&lt;br&gt;&amp;nbsp; - chapterDeleteContent = JSON.parser(chapterDeleteMessage.content)&lt;br&gt;&amp;nbsp; - DeleteMessage(chapterDeleteContent.messageId)&lt;br&gt;&amp;nbsp; - chapterMessageList = ChapterMessageList.where(x=&amp;gt;x.chapterMessageId == chapterDeleteContent.messageId)&lt;br&gt;&amp;nbsp; - if(chapterDeleteContent.DeleteAllMessages)&lt;br&gt;&amp;nbsp; &amp;nbsp; - ChapterMessageLists.remove(chapterDeleteMessage.chapterId)&lt;br&gt;&amp;nbsp; - else&lt;br&gt;&amp;nbsp; &amp;nbsp;- foreach(message in chapterMessageList) Process(message)&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font&gt;- getAllStandardMessages()&lt;br&gt;&amp;nbsp; - standardMessages = Messages.filter(m =&amp;gt; IsStandardMessage(m))&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="850" y="2000" width="760" height="1410" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>